<div class="auth-main-layout upgraded-auth">
  <div class="auth-side upgraded-auth-side">
    <img src="/img/logo.png" alt="FrameIt Logo" class="auth-logo" />
    <div class="auth-title-side">
      <span class="nowrap-title">
        Manage your <br/>
        <span class="brand-simple">FrameIt App</span>
      </span>
    </div>
  </div>
  <div class="auth-container upgraded-auth-container">
    <div class="auth-form-card upgraded-auth-card">
      <div class="auth-form-title upgraded-auth-title">
        {{ isLogin() ? 'Login' : 'Register' }}
      </div>
      <form [formGroup]="authForm" (ngSubmit)="submit()">
        <div class="auth-form-fields">
          <mat-form-field appearance="outline" class="upgraded-auth-field">
            <mat-label>Email</mat-label>
            <input matInput formControlName="email" type="email" autocomplete="username" />
            @if(authForm.get('email')?.hasError('required')) {
              <mat-error>
                Email is required
              </mat-error>
            }
            @if(authForm.get('email')?.hasError('email') && !authForm.get('email')?.hasError('required')) {
              <mat-error>
                Invalid email address
              </mat-error>
            }
          </mat-form-field>
          <mat-form-field appearance="outline" class="upgraded-auth-field">
            <mat-label>Password</mat-label>
            <input matInput [type]="hidePassword ? 'password' : 'text'" formControlName="password" autocomplete="current-password" />
            <button
              mat-icon-button
              matSuffix
              type="button"
              (click)="togglePasswordVisibility()"
              [attr.aria-label]="hidePassword ? 'Show password' : 'Hide password'"
              [attr.title]="hidePassword ? 'Show password' : 'Hide password'"
              class="password-toggle-btn"
              tabindex="0"
            >
              <mat-icon fontSet="material-icons" fontIcon="{{ hidePassword ? 'visibility_off' : 'visibility' }}"></mat-icon>
            </button>
          </mat-form-field>
        </div>
        <div class="auth-form-actions upgraded-auth-actions">
          <button mat-raised-button color="primary" type="submit" [disabled]="authForm.invalid || isLoading" class="upgraded-auth-btn">
            {{ isLogin() ? 'Login' : 'Register' }}
            <mat-progress-spinner *ngIf="isLoading" diameter="20" mode="indeterminate"></mat-progress-spinner>
          </button>
          <div class="toggle-link upgraded-auth-toggle" (click)="toggleMode()">
            {{ isLogin() ? 'Need an account? Register' : 'Already have an account? Login' }}
          </div>
        </div>
      </form>
    </div>
  </div>

  @if(loginError()) {
    <div class="error-message upgraded-auth-error">
      <mat-icon>error</mat-icon>
      <span>{{ loginError() }}</span>
    </div>
  }
</div>